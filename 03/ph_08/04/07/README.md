# システム開発のライフサイクルとセキュリティ

構築するWebシステムに求められるログはさまざまなので、目的に合わせたログを記録するように設計

## 開発の各段階でセキュリティを検討

* ソフトウェア開発では、各段階でセキュリティの検討が必要
    * 特に、要件定義や基本設計の段階から、システムの機能要件と共に非機能要件であるセキュリティを検討する
* リリース直前にセキュリティ診断を受けて、大きな問題が発見されると、場合によっては設計工程からやり直す、いわゆる「手戻り」が発生する

## ログの設計と運用

* Webシステムでは様々なログを出力します。Webサーバーが出力するアクセスログやエラーログは、アクセス解析に利用可能
* アクセスログは、主にコンテンツ担当者やマーケティング担当者が利用する
* アプリケーションが出力するログは、主にアプリケーション開発者・運用者が、障害発生時の問題分析に使う
* どのようなログを取得し、どのように保管・運用するかは、Webシステムの要件定義では後回しにされがち

### セキュリティ観点でのログの意義

* Webサイト改ざんや情報漏えいなどのインシデントが発生したときに、原因を特定する
    * 発生した事象
    * インシデントの経緯(いつ、誰が、何をしたのか)
    * 影響範囲(重要情報が閲覧されたのかどうか、件数はどれくらいあるのか)
    * なぜ、被害にあってしまったのか(原因)
    * 再発防止策
* 管理者による内部不正が行われていないか、Webシステムの操作を監査する
    * 内部不正対策
    * システム管理者や運用者によるWebシステム操作としては、「ユーザーの新規登録」「ユーザーの登録情報の変更」のほかに、ユーザーからの依頼による非定型の作業がある
* Webシステムに対する攻撃の予兆を検知する

### ログに出力する項目

* アクセス日時
* リモートIPアドレス
* セッションを特定できる情報
* ユーザーID
* URLやアプリケーションID
* 操作内容(参照・登録・更新・削除)
* 実行結果(成功・失敗、件数)

### ログに記録すべきイベント

* ログイン(成功・失敗)
* ログアウト
* パスワードの変更
* 重要な登録情報の変更(メールアドレスなど)
* ユーザーの追加・削除
* アクセス権の変更を伴う操作
    * 特定のユーザーに対して許可する機能やアクセス権を変更する操作
* 重要情報の参照
* 大量データの参照
* システム管理者の操作
    * 管理者権限で実行された操作

### ログの出力先は、Webサーバーとは別の「ログサーバー」が理想

* 攻撃者によってログが改ざん・削除されてしまうことを防げる
* Webシステムのサーバーとログサーバーを分離し、それぞれのサーバーの管理者を別々に立てると、内部不正の隠ぺいを抑止する効果も期待できる
* ログサーバーへのログ転送は、syslogサービスを利用可能
* 要件定義の段階では、ログの保存期間と方法についても検討

### セキュリティをシステム開発に根付かせる

* セキュリティに関する教育を施していく必要がある
* 会社の中で人材育成や品質管理に発言力のある人を巻き込んで、予算と人員を確保し、組織的な取り組みにしていく

## まとめ

### システム開発の各段階でセキュリティを検討する

* リリース直前のセキュリティ診断で大きな問題が見つかると手戻りが生じる
* セキュリティに関するテストを、開発の初期から取り入れる
* 日常的な運用監視に加え、定期的なソフトウェアのアップデートや、新たな脆弱性への対応が必要。運用時にかかる費用・体制もあらかじめ盛り込んでおく

### ログの設計と運用

* セキュリティの観点からログが必要な理由は、「インシデント発生時の原因特定」「Webシステムに対する操作の監査」「攻撃の予兆検知」のため
* 目的に合わせて「ログに記録する項目」「ログに記録するイベント」を定義する
* 保存期間は「サーバー上に保存する期間」と「長期保存が必要な期間」に分けて検討する
* ログを保存するだけでなく、一歩進んで活用する方法としては、SIMやSEMがある

### セキュリティをシステム開発に根付かせる

* 品質改善は開発エンジニア任せにせず、組織的に取り込んでいく
* 開発言語やフレームワークの教育と同じように、セキュリティに関する教育が必要