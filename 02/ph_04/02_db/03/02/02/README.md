# 取得する行を必要最低限にする

* フェッチを使用する
    * フェッチ: DBから照会(SELECT)したデータをプログラムが取り出すこと
    * SQLで取得する最大行数やフェッチ行数を指定可能
* 最大行数はSQLの結果の最大行数
    * 最大行数を100と指定すれば、200行がWHFRE条件に合致しても、100行だけ取得
    
## ResultSet

* JDBCでは、StatementやResultSetにある最大行数maxRowsを指定することで行える
* クライアントのプログラムでは、SQLの結果をJDBCの`ResultSet`を使って取得する
    * ResultSet: SQLの結果データを取り出すためのクラス
        * 結果データをカーソルが指している`一行`ごとに取得可能
    * `ResultSet#next()`で`カーソルを次に進める`ことができる
    * SQLを実行してResultSetが作成されても、SELECTしたすべての行のデータをDBサーバーからクライアントに送信しているわけではない
        * SELECTの結果が1000行であったとしても、いきなり1000行のデータをResultSetに格納するわけではない
    * プログラムから`ResultSet#next`メソッドを呼ばれると、ResultSetの実装が裏で自動的にDBサーバーに取りに行ってくれる

## 行数の指定

* ResultSetの実装は何行分をDBサーバーに取りに行くのか
    * 毎回、1行ずつDBサーバーから取得するのでは、ネットワークのオーバーヘッドが大きくなり、パフォーマンスが悪くなる
    * プログラムが使いそうな分だけまとめて取得してキャッシュしてほしい
    * しかしResultSetには要件がわからない
        * プログラムが当面1行だけを必要としているのか
        * 100行を必要としているのかはetc,,
    * そこで`fetchSize`と`fetchDirection`を指定する
        * fetchSize
            * プログラムが一度に必要とする行数を指定する
        * fetchDirection
            * まとめて取得する行がカーソル位置から見た方向を指定する
                * 順方向(FORWARD)なのか
                * 逆方向(REVERSE)なのか
* これにより、ResultSetは必要最低限のデータだけをクライアント側に取得してキャッシュする
* JDBCドライバ側でキャッシュされたものについては、DBの更新が反映されない
    * そのため、ResultSetの情報をDBの最新の情報にするのに、ResultSetには`refreshRow()`が提供されている