# 平均

* 自分で数式を作成する方法
* AVERAGE関数を用いる方法

## 自分で数式を作成する方法

* 最初に合計人数を求める
  * セル`A9` に `合計人数`と入力し、`B9` を選択する
  * `B9` に `=B2 + B3 + B4 + B5 + B6 + B7 +B8` と入力する
* 個数で割る
  * セル`A10` に `平均人数` と入力する
  * セル`B10` に `=B9/7` と入力する

## AVERAGE関数を用いる方法

* セル`A9` に `平均人数`と入力し、`B9` を選択する
* `B9` を選択し、`ΣオートSUMM▼` から `平均` を選択

# 中央値

* 2010
  * セル `C22` を選択し、`ΣオートSUMM▼` から `その他の関数` を選択
    * 関数の分類: `統計`
    * 関数名: `MEDIAN`
* 365
  * セル `C22` を選択し、`=MEDIAN(C4:C19)`

# 最頻値

* 2010
  * セル `C23` を選択し、`ΣオートSUMM▼` から `その他の関数` を選択
    * 関数の分類: `統計`
    * 関数名: `MODE.SNGL`
* 365
  * `=MODE.SNGL(C4:C19)`

# レンジ

* 下記を入力
  * `D11` に `最大値`
  * `D12` に `最小値`
  * `D13` に `範囲`
* 最大値を求める
  * `E11` を選択し、`ΣオートSUMM▼` から `最大値` を選択
* 最小値を求める
  * `E12` を選択し、`ΣオートSUMM▼` から `最小値` を選択
* 範囲を求める
  * `=E11-E12` と入力する

# 標準偏差

* Excel関数を使用しない方法
* Excel関数を使用する方法

## Excel関数を使用しない方法

* 必要な項目を入力する
  * `C2`: `売上高と平均売上高の差`
  * `D2`: `偏差の二乗`
  * `A16`: `売上高の平均`
  * `A17`: `分散`
  * `A18`: `標準偏差`
* 平均を求める
  * `B16` を選択し、`ΣオートSUMM▼` から `平均` を選択
* 売上高の平均から、各月の売上高を引いた値を求める
  * `C3` を選択し、 `=B$16 - B3` と入力する
  * `C14` まで数式をコピーする
* 売上高平均と売上高の差の二乗(偏差の二乗)を求める
  * `D3` を選択し、`=C3^2` と入力する
  * オートフィルで `D14` まで数式をコピーする
* 分散を求める
  * `B17` を選択し、 `AVARAGE` で `D3` から `D14` の平均を算出する
* 標準偏差を求める
  * `B18` を選択し、`=SQRT(B17)` と入力する

## Excel関数を使用する方法   

* セルの用意
  * `A16`: `標準偏差(STDEV.P)`
  * `A17`: `標準偏差(STDEV.S)`
* `STDEV.P` を求める
  * `B16` を選択し、`ΣオートSUMM▼` から `STDEV.P` を選択し、範囲選択
  * `B17` を選択し、`ΣオートSUMM▼` から `STDEV.S` を選択し、範囲選択

# 外れ値

* 散布図の外れ値を検出する
* 折れ線グラフの外れ値を検出する

## 散布図の外れ値を検出する

* データ範囲を選択し、`散布図` を選択
  * `散布図またtはバブルチャートの挿入`
    * `挿入タブ` の `グラフグループ` にある、
* 近似曲線を挿入する
  * グラフを選択し、`+` アイコンを押下する
    * 2010の場合は、`グラフツール > レイアウト > 近似曲線 > 線形近似曲線`
    * 365の場合は、`グラフ要素を追加 > 近似曲線`

## 折れ線グラフの外れ値を検出する

* 事前準備
  * `C1`: `最低基準`
  * `D1`: `最高基準`
  * `C列`: 40
  * `D列`: 120
* 範囲を全選択し、`挿入タブ` の `グラフグループ` から `折れ線グラフ` を選択

# 度数分布表

* 相対度数を作成する
  * `F列` に `相対度数` 列を追加する
  * `E11` に度数の合計を表示する
  * `F2` に `=E2/20` を入力し、 `F9` までオートフィルで数式をコピー
* 累積度数を作成する
  * `G1` に `累積度数` と記入する
  * `G2` に `=E2` と入力する
  * `G3` に `=G2+E3` と入力する
  * `G3` からオートフィルで `G9` まで埋める
* 累積相対度数を作成する
  * `H1` に `累積相対度数` と記入する
  * `H2` に `=F2` と記入する
  * `H3` に `=H2+F3` と記入する
  * `H3` からオートフィルで `H9` まで埋める

# ヒストグラム

* `D1` から `E9` を選択する
* `挿入タブ` の `グラフグループ` から `集合縦棒` を選択
* タイトルを `部署別従業員数` に変更する
* グラフの間隔を詰める
  * グラフにマウスを当て右クリックし、 `データ系列の書式設定` を選択
  * 要素の間隔を `0` に変更する
* グラフの軸ラベルを作成する
  * `グラフのデザイン` タブから `グラフ要素の追加` を選択
    * `軸ラベル`
      * `第一縦軸`
      * `第一横軸`

# 標準化

* 事前準備
  * `A8` に `平均` と入力する
  * `A9` に `標準偏差` と入力する
* 各平均を算出する
  * `B8` に `=AVERAGE(B3:B7)` と入力する
  * `C8` と `D8` をオートフィルで埋める
* 標準偏差を算出する
  * `B9` に `=STDEV.S(B3:B7)` と入力する
  * `C9` と `D9` をオートフィルで埋める
* 標準化後の表を作成する
  * `A1:D9` をコピーし、 `A11` に貼り付け
  * タイトルを `商品売上データ(標準化後)` に変更する
  * `B13:D17` のデータを削除し、空のにする
* 標準化する
  * `B13` を選択し、`ΣオートSUMM▼` から `=STANDARDIZE` を選択
    * X: `B3`
    * 平均: `B$8`
    * 標準偏差: `B$9`
  * オートフィルで `B13:D17` を埋める
* 平均と標準偏差を算出し、以下の値となることを確認する
  * 平均: 0.00
  * 標準偏差: 1.00

# 移動平均

* 事前準備
  * データのダウンロード
    * https://www.meti.go.jp/statistics/tyo/tokusabido/index.html
    * `調査の結果 > 統計表一覧 > 長期データ > クレジットカード業`
    * `月・実数` シートの2007年から2014年までの`月次の売り上げ` をコピーペースト
  * 分析アドインの追加
    * Mac: `ツール > Excelアドイン` で `分析ツール` にチェックを入れる
* 移動平均の結果を出力する
  * `C1` を選択し、`データ` タブの `データ分析` を押下
  * `データ分析` ダイアログボックスから `移動平均` を選択して `OK` を押下
    * 入力範囲: `$B$2:$B$97`
    * 区間: 12
    * 出力先: `$C$2`
  * グラフに出力する

# 季節調整

* 事前準備
  * データのダウンロード
    * https://www.meti.go.jp/statistics/tyo/tokusabido/index.html
    * `調査の結果 > 統計表一覧 > 長期データ > 自動車賃貸業`
    * `月・実数` シートの2009年1月から2015年8月までの`月次の売り上げ` をコピーペースト
  * `C1` に `移動平均` と入力する
    * 入力範囲: `$B$2:$B$97`
    * 区間: 12
    * 出力先: `$C$2`
  * `D1` に `季節要因` と入力する
  * `D13` を選択し、 `=B13/C13` と入力する
  * `D81` までオートフィルでコピーする

| 月  | 売上高 | 移動平均 |
|:---:|:-----:|:------:|
| 1月 | hoge1 | moge1  |
| 2月 | hoge2 | moge2  |

* `別シート` に新規に表を作成する

|   | 1月 | 2月 |
|:---:|:-----:|:------:|
| 2010年 | hoge1 | moge1  |
| 2011年 | hoge2 | moge2  |

* 項目の準備
  * `A9` に `最大値(MAX)` と記入する
  * `A10` に `最小値(MIN)` と記入する
  * `A11` に `トリム平均` と記入する
* 値の準備
  * `最大値` を `B9` から `M9` まで埋める
  * `最小値` を `B10` から `M10` まで埋める
* 最大値と最小値を色分けする
* トリム平均を算出する
  * データの合計 割る 個数
    * `=ROUND((B5+B6+B7+B8)/4, 2)`
    * `=ROUND((C3+C6+C7+C8)/4, 2)`
    * `=ROUND((D3+D5+D6+D8)/4, 2)`
    * `=ROUND((E4+E5+E6+E7)/4, 2)`
    * `=ROUND((F5+F6+F7+F8)/4, 2)`
    * `=ROUND((G4+G5+G6+G8)/4, 2)`
    * `=ROUND((H4+H5+H6+H8)/4, 2)`
    * `=ROUND((I4+I5+I6+I8)/4, 2)`
    * `=ROUND((J4+J5+J6)/3, 2)`
    * `=ROUND((K3+K6+K7)/3, 2)`
    * `=ROUND((L3+L4+L6)/3, 2)`
    * `=ROUND((M4+M5+M6)/3, 2)`
* `N10` に `合計値` と入力する
* `N11` に `トリム平均の合計` を算出する
* トリム平均の合計を調整する
  * `補正値` と算出する
    * `12/合計値`
    * `A13` に `補正値` と入力する
    * `A14` に `=ROUND(12/N11, 2)`
  * トリム平均の合計が `12` になるように調整する
    * `A12` に `補正トリム平均` と入力する
    * `A13` に `=A11 * A$13`
* `E1` に `季節変動値(季節指数)` と入力する
* `元のデータ` を `季節変動値` で割る
  * `F2` に `季節調整済み売上高` と入力する
  * `F2` に `=B2/E2` と入力し、オートフィルする
* グラフに表す

# 集計

* `A1` を選択
* `ピボットテーブル` を押下
  * 行: `性別`
  * 値: `購入金額`
  * 値フィールドの設定: `平均`
* 質的変数(原因)から質的変数(結果)の仮説を検証する
  * `量的変数` を得る
    * 2000円を条件にランク分けする
      * `列E` に `購買ランク` と記入する
      * `E2` を選択して `=IF(D2>=2000,"A","B")` と入力する
    * さらに細かくランク分けする
      * `E2` のデータを削除する
      * `E2` に以下の条件文を記入する
         * `=IF(D2>=2000,"A",IF(D2>=1500,"B",IF(D2>=1000,"C","D")))`
* 各ランクに何人いるか集計する
  * ピボットテーブルの新規作成
    * 列: 購入ランク
    * 値: 購入ランク
* クロス集計表を作成する
  * ピボットテーブルの `行` に `性別` を追加する
* 割合を計算し、データの個数の違いを調整する
  * `値フィールド` の `データの個数/購買ランク` の `▼`
  * `計算の種類` タブ
  * `行集計に対する比率` をプルダウンから選択
* グラフの作成
  * `ピボットテーブル分析` タブの `ピボットグラフ` を選択
  * グラフの変更
    * 作成されたグラフを右クリックし `グラフの種類の変更`
    * `縦棒` から `100%積み上げ横棒` を選択

# 散布図

* 量的変数と量的変数の関係をグラフ化する
  * 折れ線グラフ
  * 散布図

## 折れ線グラフ

* `A32`, `C32`, `D32` までを選択する
* 折れ線グラフを作成する
* `アルコール` 系列を選択し、`データ系列の書式設定` を選択
  * `第二軸` を選択する

## 散布図

* `C1` から `D32` までを選択
* `グラフ` から `散布図` を選択

# 相関

* `分析ツール` から `相関` を選択
  * 入力範囲: `$C$1:$G$32`
  * データ方向: `列`
  * `先頭行をラベルとしてチェック`: チェックを入れる

# 回帰分析

* 直接関係を調べる
* 分析ツールで回帰分析を行う

## 直接関係を調べる

* `B1` から `C32` を選択
* バブルチャートを作成する
  * 横軸を選択
    * 最小値: 150
    * 最大値: 220
* 近似曲線の追加
  * データを選択し、右クリックし近似曲線を追加
  * `線型近似` を選択し、 `グラフに数式を表示する` にチェックを入れる
  * `グラフにR-2乗値`

## 分析ツールで回帰分析を行う

* データ分析から `回帰分析` を選択
  * 入力 Y 範囲: `$C$1:$C$32`
  * 入力 X 範囲: `$D$1:$D$32`
  * `ラベル` にチェック
  * `残渣` にチェック

# 最適化

* `B3` に `=B8*B1+B9` を入力し、 `20.86` となることを確認する

## ソルバー

* 最適化の結果をコピーする
* `ツール > Excelアドイン` から `Solver Add-In` にチェックを入れる
* データから `ソルバー` を選択
  * 目的セルの設定: `$B$5`
  * 目標値: 最大値
  * 変数セルの設定: `$B$1`
  * 制約条件の対象:
    * セル参照: `$B$1`
    * `int`
    * 制約条件: `整数`
